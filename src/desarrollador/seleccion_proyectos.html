<!DOCTYPE html>
<html lang="es">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="utf-8" />
    <title>Sistema de Gestión de Horas - Selección de Proyectos</title>
    <link rel="stylesheet" href="/src/common/globals.css" />
    <link rel="stylesheet" href="/src/common/styleguide.css" />
    <link rel="stylesheet" href="seleccion_proyectos.css" />
  </head>
  <body>
    <main class="proyectos">
      <header class="rectangle">
        <h1 class="div">SISTEMA DE GESTIÓN DE HORAS</h1>
        <div class="user-info">
          <span class="text-wrapper-2">Desarrollador</span>
          <div class="user" aria-label="Icono de usuario">
            <svg class="icon-3" width="24" height="24" viewBox="0 0 24 24" fill="white">
              <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
            </svg>
          </div>
        </div>
      </header>
      
      <div class="content-wrapper">
        <h2 class="text-wrapper-3">Seleccione su Proyecto</h2>
        
        <div class="project-list" >
          <section class="frame" id="contenedor_tarjetas">
            <p>cargando...</p>
          </section> 
          
          </section>
        </div>
      </div>
      
      <div class="button-wrapper">
        <a href="../index.html" class="button-2" type="button">
          <span class="button-3">Volver al Inicio</span>
        </a>
      </div>
    </main>

    <script src="../APIClient.js"></script>
    <script>
      const parametros = new URLSearchParams(window.location.search);
      const idRecurso = parametros.get('id');

      let proyectos = [];
      // cargar los proyectos
      APIClient.getProjectsByEmployeeId(idRecurso).then( proyectos => {

        console.log(proyectos);
        const contenedorTarjetas = document.querySelector("#contenedor_tarjetas");
            if(proyectos.length == 0) {
              contenedorTarjetas.innerHTML = "no hay proyectos para este empleado";
            } else {
              proyectos.forEach(proyecto => {
                contenedorTarjetas.innerHTML ="";
                contenedorTarjetas.innerHTML += crearTarjeta(proyecto);
              });

            }


      });

      function crearTarjeta(proyecto) {
        return `<article class="project-card">
              <div class="rectangle-2">
                <svg class="folder" width="24" height="24" viewBox="0 0 24 24" fill="#8f0b09">
                  <path d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"/>
                </svg>
                <h3 class="text-wrapper-6" id="">${proyecto.nombre}</h3>
                <div class="frame-2" aria-hidden="true"></div>
                <a href="carga_horas.html?projectId=${proyecto.id}&projectName=${proyecto.nombre}&resourceId=${idRecurso}" class="text-wrapper-5">Ver proyecto</a>
              </div>
            </article>`
      }

    </script>
  </body>
</html>